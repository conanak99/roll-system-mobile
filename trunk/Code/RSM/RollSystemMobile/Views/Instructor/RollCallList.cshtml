@model RollSystemMobile.Models.ViewModels.InstructorViewModel
@{
    ViewBag.Title = "RollCallList";
}

@section ExtraHead {
    <style>
        #calendar
        {
            width: 650px;
            margin: 0 auto;
            font-size: 85%;
        }
        
        .fc-event-inner
        {
            line-height: normal;
            text-align: center;
        }
        
        .datepicker{z-index:1151;}
    </style>
    <link href="@Url.Content("~/Content/Plug-in/FullCalendar/fullcalendar.css")" rel="stylesheet"
        type="text/css" />
    <script src="@Url.Content("~/Content/Plug-in/FullCalendar/js/fullcalendar.js")" 
    type="text/javascript"></script>
}


<div>
<h4>
    My current teaching classes.</h4>
    <table class="table table-condensed table-bordered">
        <thead>
            <tr>
                <th>
                    No
                </th>
                <th>
                    Class
                </th>
                <th>
                    Subject
                </th>
                <th>
                    Time
                </th>
                <th>
                    Date
                </th>
                <th class="text-center">
                    Action
                </th>
            </tr>
        </thead>
        <tbody>
            @{ int rollIndex = 1;}
            @foreach (var RollCall in Model.TeachingRollCall)
            {
                bool IsCurrentRollCall = Model.CurrentRollCall != null && RollCall.RollCallID == Model.CurrentRollCall.RollCallID;   
                <tr class="@(IsCurrentRollCall ? "success" : "")">
                    <td>
                        @rollIndex
                    </td>
                    <td>
                        @RollCall.Class.ClassName
                    </td>
                    <td>
                        @RollCall.Subject.ShortName
                    </td>
                    <td>
                       @Html.FormatTime(@RollCall.StartTime) -  @Html.FormatTime(@RollCall.EndTime)
                    </td>
                    <td>
                        @Html.FormatDate(@RollCall.BeginDate) to @Html.FormatDate(@RollCall.EndDate)
                    </td>
                    <td class="text-center">
                        @if (!IsCurrentRollCall)
                        {
                            <a class="btn btn-info btn-small" href="@Url.Action("RollCallDetail", "Instructor", new { id = @RollCall.RollCallID })">
                                View Detail</a>
                        }
                        else
                        {
                            <a class="btn btn-success btn-small" href="@Url.Action("Index", "Instructor")">Take Attendance</a>
                            <a class="btn btn-info btn-small" href="@Url.Action("RollCallDetail", "Instructor", new { id = @RollCall.RollCallID })">
                                View Detail</a>
                        }
                    </td>
                </tr>
                        { rollIndex++; }
            }
        </tbody>
    </table>

  
    <h4>Teaching Schedule</h4>
<div id='calendar'>
</div>
<script>
    $(document).ready(function () {

        $('#calendar').fullCalendar({
            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,basicWeek,basicDay'
            },
            editable: false,
            events: '@Url.Action("GetTeachingSession","Instructors", new { InstructorID =  Model.AuthorizedInstructor.InstructorID})',
            eventClick: function (calEvent, jsEvent, view) {
            },
            eventRender: function (event, element) {
                if (isPastDay(event.start)) {
                    //Chuyen qua mau xam
                    element.css('background-color', 'gray');
                    element.css('border', '1px solid gray');
                }
                else {

                }
            }
        });

    });

    function isPastDay(day) {
        var check = $.fullCalendar.formatDate(day, 'yyyy-MM-dd');
        var today = $.fullCalendar.formatDate(new Date(), 'yyyy-MM-dd');
        if (check <= today) return true;
        else return false;
    }
</script>

</div>

