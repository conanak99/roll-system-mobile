@model RollSystemMobile.Models.Instructor
@{
    ViewBag.Title = "Teaching Calendar";
}
@section ExtraHead {
    <style>
        #calendar
        {
            width: 900px;
            margin: 0 auto;
            font-size: 105%;
        }
        
        .fc-event-inner
        {
            line-height: normal;
            text-align: center;
        }
    </style>
    <link href="@Url.Content("~/Content/Plug-in/FullCalendar/fullcalendar.css")" rel="stylesheet"
        type="text/css" />
    <script src="@Url.Content("~/Content/Plug-in/FullCalendar/js/fullcalendar.js")" 
    type="text/javascript"></script>
}
<ul class="breadcrumb">
    <li><a href="@Url.Action("Index_Home")" class="glyphicons home"><i></i>Home</a></li>
    <li class="divider"></li>
    <li>Teaching Calendar</li>
</ul>
<div class="separator bottom">
</div>
<div class="innerLR">

@if (ViewBag.Message != null)
{
    <div class="alert alert-primary">
    @ViewBag.Message
    </div>
}
    <div class="widget">
        <div class="widget-head">
            <h3 class="heading glyphicons calendar">
                <i></i>Teaching Calendar</h3>
        </div>
        <div class="widget-body">
        <div class="text-center" style="padding-bottom:10px">
        @if (Model.ApiToken == null)
        {
             <a class="btn btn-primary" href="@ViewBag.AuthUrl"><i></i>Sync with Google Calendar</a>
        }
        else
        {
            <a class="btn btn-primary" href="@ViewBag.AuthUrl"><i></i>Renew Token</a>
            <a class="btn btn-info" href="@Url.Action("SyncManual")">Request Calendar Sync Now</a>
        }
       
       </div>
            <div id='calendar'>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {

        $('#calendar').fullCalendar({
            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,basicWeek,basicDay'
            },
            editable: false,
            events: '@Url.Action("GetCalendarEvent", "Instructors", new { InstructorID = Model.InstructorID })',
            eventClick: function (calEvent, jsEvent, view) {
            },
            eventRender: function (event, element) {
                if (isPastDay(event.start)) {
                    //Chuyen qua mau xam
                    element.css('background-color', 'gray');
                    element.css('border', '1px solid gray');
                }
                else {

                }
            }
        });

    });

    function isPastDay(day) {
        var check = $.fullCalendar.formatDate(day, 'yyyy-MM-dd');
        var today = $.fullCalendar.formatDate(new Date(), 'yyyy-MM-dd');
        if (check <= today) return true;
        else return false;
    }
</script>
