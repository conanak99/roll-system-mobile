@model RollSystemMobile.Models.Request
@{
    ViewBag.Title = "Request Detail";
}
@section ExtraHead {
    <style>
        body
        {
            background-color: White;
        }
    </style>
}
<ul class="breadcrumb">
    <li><a href="@Url.Action("Index")" class="glyphicons home"><i></i>Home</a></li>
    <li class="divider"></li>
    <li>Detail request</li>
</ul>
<div class="separator bottom">
</div>
<div class="innerLR">
    <div class="widget">
        <div class="widget-head">
            <h3 class="heading glyphicons user">
                <i></i>Request Detail</h3>
        </div>
        <div class="widget-body">
            <b>Student :</b> @Model.Student.FullName<br />
            <b>Student Code :</b> @Model.Student.StudentCode<br />
            <b>Class :</b> @Model.Student.Class.ClassName<br />
            <b>Images :</b><br />
            @foreach (var image in @Model.RequestImages)
            {
                <div class="thumbnail-holder">
                    <img class="thumbnail" src="@Url.TrainingImage(image.ImageLink)" />
                    <button type="button" class="close btn-delete" imageID="@image.ImageID" data-dismiss="modal" aria-hidden="true">
                        ×</button>
                </div>
            }<br />
            <a class="btn btn-primary" onclick="acceptRequest('@Model.RequestID','@User.Identity.Name')">
                Accept</a> <a class="btn btn-warning" onclick="ReRequest('@Model.RequestID','@User.Identity.Name')">Deny. Send request again</a>
        </div>
    </div>
</div>
<script>
    $('button.btn-delete').click(deleteImage);
    //Delegate toi ham nay, khi click vao thi xoa anh
    function deleteImage() {
        var imageName = $(this).prev().attr('src');
        var imageID = $(this).attr('ImageID');
        var image = $(this);

        var con = confirm("Do you really want to delete this image?");
        if (con) {
            $.post('@Url.Action("DeleteRequestImage", "Image")',
              { ImageID: imageID }, function (data) {
                  image.parent().hide('slow');
              }, 'json');
        }
    }
    function acceptRequest(requestID, name) {
        var link = '@Url.Action("AcceptRequest", new { requestID = "tmp1", name = "tmp2" })';
        link = link.replace("amp;", "");
        link = link.replace("amp;", "");
        link = link.replace("tmp1", requestID);
        link = link.replace("tmp2", name);
        link = link.replace("System.Security.Principal.GenericIdentity", "");
        window.location.href = link;
    }
    function ReRequest(requestID, name) {
        var link = '@Url.Action("DenyRequest", new { requestID = "tmp1", name = "tmp2" })';
        link = link.replace("amp;", "");
        link = link.replace("amp;", "");
        link = link.replace("tmp1", requestID);
        link = link.replace("tmp2", name);
        link = link.replace("System.Security.Principal.GenericIdentity", "");
        window.location.href = link;
    }
</script>
